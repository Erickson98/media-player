<script>
  function getCookie(name) {
    const value = `; ${document.cookie}`;
    const parts = value.split(`; ${name}=`);
    if (parts.length === 2) return parts.pop().split(";").shift();
    return null;
  }
  window.onSpotifyWebPlaybackSDKReady = () => {
    let token = getCookie("access_token");

    const player = new Spotify.Player({
      name: "Web Playback SDK Example",
      getOAuthToken: (cb) => {
        cb(token);
      },
      volume: 0.5,
    });

    let deviceId = null;

    player.addListener("ready", ({ device_id }) => {
      deviceId = device_id;
      console.log("Player ready with device ID", device_id);
    });

    player.addListener("initialization_error", ({ message }) => {
      console.error(message);
    });
    player.addListener("authentication_error", ({ message }) => {
      console.error(message);
    });
    player.addListener("account_error", ({ message }) => {
      console.error(message);
    });
    player.addListener("playback_error", ({ message }) => {
      console.error(message);
    });

    player.connect();
  };
</script>

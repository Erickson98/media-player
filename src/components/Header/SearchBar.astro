<!-- CONTENEDOR (solo para centrar en el ejemplo) -->
<link rel="stylesheet" href="/SearchBarHeader.css" />
<div class="dock central header-center">
  <!-- Botón Home (izquierda, separado) -->
  <a href="/" class="icon-btn" aria-label="Home">
    <!-- Home icon -->
    <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true">
      <path
        fill="currentColor"
        d="M12 3.2 3 10v9a2 2 0 0 0 2 2h5v-6h4v6h5a2 2 0 0 0 2-2v-9l-9-6.8Z"
      ></path>
    </svg>
  </a>

  <!-- Barra de búsqueda -->
  <form
    class="searchbar"
    role="search"
    action="#"
    method="get"
    aria-label="Buscar"
  >
    <!-- Lupa -->
    <span class="searchbar__icon" aria-hidden="true">
      <svg viewBox="0 0 24 24" width="22" height="22">
        <path
          fill="currentColor"
          d="M15.5 14h-.8l-.3-.3a6.5 6.5 0 1 0-.9.9l.3.3v.8l5 5 1.5-1.5-5-5Zm-6 0A4.5 4.5 0 1 1 14 9.5 4.5 4.5 0 0 1 9.5 14Z"
        ></path>
      </svg>
    </span>

    <!-- Campo -->
    <input
      class="searchbar__input"
      type="search"
      name="q"
      placeholder="What do you want to play?"
      autocomplete="off"
      aria-label="What do you want to play?"
    />

    <!-- Divisor -->
    <span class="searchbar__divider" aria-hidden="true"></span>

    <!-- Botón derecho (inbox/tray) -->
    <button
      class="icon-btn icon-btn--inset"
      type="button"
      aria-label="Open queue"
    >
      <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true">
        <path
          fill="currentColor"
          d="M19 3H5a2 2 0 0 0-2 2v14a1 1 0 0 0 1 1h6.4a1 1 0 0 0 .9-.6l.7-1.4h4.5l.7 1.4a1 1 0 0 0 .9.6H20a1 1 0 0 0 1-1V5a2 2 0 0 0-2-2Zm-1 12h-4.2a1 1 0 0 0-.9.6l-.7 1.4H6l1.7-3.3a1 1 0 0 1 .9-.6H18v1.9ZM18 6v6H8.6a2 2 0 0 0-1.8 1.1L5 16.7V5a1 1 0 0 1 1-1h12a0 0 0 0 1 0 0Z"
        ></path>
      </svg>
    </button>
  </form>
</div>

<style>
  :root {
    --bg: #0f0f0f; /* fondo página */
    --pill: #1a1a1a; /* fondo barra */
    --pill-border: #2a2a2a; /* borde barra */
    --text: #e6e6e6; /* texto */
    --muted: #b5b5b5; /* placeholder/iconos */
    --focus: #3d85ff; /* foco accesible */
  }
</style>
<script nonce={Astro.locals.nonce} type="module">
  import { debounce } from "/scripts/debounce.js";
  const searchElement = document.querySelector(".searchbar__input");

  const handleSearch = debounce((query) => {
    const searchQuery = query.trim().toLowerCase();
    window.dispatchEvent(
      new CustomEvent("nav:search", { detail: { searchQuery } })
    );
  }, 200);
  searchElement?.addEventListener("input", (e) => {
    const target = e.target;
    handleSearch(target.value);
  });
  const houseIcon = document.querySelector(".icon-btn");
  houseIcon?.addEventListener("click", () => {
    const isHome = window.location.href.split("/")[3];
    if (isHome === "") return;
    window.history.pushState({}, "", "/");
    window.dispatchEvent(new Event("route:home"));
  });
</script>
